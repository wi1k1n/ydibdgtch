<!DOCTYPE html>
<html>
<head>
      <title>Chess Coding Thingy</title>
      <link rel="stylesheet"
href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"
integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU"
crossorigin="anonymous">
      <style>
        .float-container {
          border: 1px solid black;
          margin: 1rem;
          padding: 2rem 2rem;
          text-align: center;
        }
        .float-child {
          display: inline-block;
          border: 1px solid red;
          padding: 1rem 1rem;
          vertical-align: middle;
        } 
      </style>
</head>
<body>
    <div>
      <button id="btnConnect">Connect</button>
    </div>
    <div class="float-container">
      <div class="float-child">
        <div id="controlPanel"></div>
      </div>
      <div class="float-child">
        <div id="myBoard"></div>
      </div>
    </div>

      <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        crossorigin="anonymous"></script>
      <script src="chessboard-1.0.0.min.js"></script>
      <script src="chess-0.10.2.min.js"></script>

      <script type="text/javascript">
            // NOTE: this example uses the chess.js library:
            // https://github.com/jhlywa/chess.js

            const BOARDSIZE = 750;

            document.getElementById('myBoard').setAttribute('style', 'width:'+BOARDSIZE+'px');

            var board = null
            var game = new Chess()

            function onDragStart (source, piece, position, orientation) {
              // do not pick up pieces if the game is over
              if (game.game_over()) return false

              // only pick up pieces for White
              if (piece.search(/^b/) !== -1) return false
            }

            function makeRandomMove () {
              var possibleMoves = game.moves();

              // game over
              if (possibleMoves.length === 0) return;

              var randomIdx = Math.floor(Math.random() * possibleMoves.length);
              game.move(possibleMoves[randomIdx]);
              board.position(game.fen());
              console.log(possibleMoves[randomIdx]);
            }

            function onDrop (source, target) {
              // see if the move is legal
              var move = game.move({
                from: source,
                to: target,
                promotion: 'q' // NOTE: always promote to a queen for example simplicity
              })

              // illegal move
              if (move === null) return 'snapback'

              // make random legal move for black
              window.setTimeout(makeRandomMove, 250)
            }

            // update the board position after the piece snap
            // for castling, en passant, pawn promotion
            function onSnapEnd () {
              board.position(game.fen())
            }

            var config = {
              draggable: false,
              // position: 'start',
              position: {},
              onDragStart: onDragStart,
              onDrop: onDrop,
              onSnapEnd: onSnapEnd
            }
            board = Chessboard('myBoard', config)
      </script>

      <script src="https://unpkg.com/konva@9.2.0/konva.min.js"></script>
      <script src="controlPanel.js"></script>
</body>
</html>